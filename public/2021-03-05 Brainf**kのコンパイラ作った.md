---
title: Brainf**kã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ä½œã£ãŸ
tags:
  - Brainf*ck
  - brainfuck
private: false
updated_at: '2021-11-12T00:23:51+09:00'
id: 5ad1760b8b4ca1d37922
organization_url_name: null
slide: false
ignorePublish: false
---
# TL;DR
![400x200.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/507500/8d6ee76f-7d13-d34e-8886-a7f8949b97d2.gif)

# ã¾ã˜ã‚ãªèª¬æ˜

## Brainf\*\*kã«ã¤ã„ã¦
ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚çªç„¶ã§ã™ãŒBrainf\*\*kã¨ã„ã†è¨€èªã‚’ã”å­˜çŸ¥ã§ã—ã‚‡ã†ã‹ã€‚
Brainf\*\*kã¯Urban MÃ¼llerã¨ã„ã†äººãŒä½œã£ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã§ã€ã„ã‚ã‚†ã‚‹ã€Œé›£è§£ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã€ã®ä»£è¡¨ã«ã‚ˆãæŒ™ã’ã‚‰ã‚Œã¾ã™ã€‚
å…·ä½“çš„ãªä»•æ§˜ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚<sup>[å‡ºå…¸ä¸æ˜]</sup>

***

* Brainf**kã«ã¯é…åˆ—ãŠã‚ˆã³ãã®è¦ç´ ã‚’æŒ‡ã™ãƒã‚¤ãƒ³ã‚¿ãŒä¸€ã¤ã‚ã‚‹ã€‚
 * é…åˆ—ã®è¦ç´ ã¯1ãƒã‚¤ãƒˆã€è¦ç´ æ•°ã¯æœ€ä½ã§ã‚‚30000å€‹ã‚ã‚Šã€0ã§åˆæœŸåŒ–ã•ã‚Œã‚‹ã€‚
 * ãƒã‚¤ãƒ³ã‚¿ã¯ã¯ã˜ã‚ã¯é…åˆ—ã®å…ˆé ­ã‚’æŒ‡ã—ã¦ã„ã‚‹ã€‚
* å‘½ä»¤ã¯ä»¥ä¸‹ã®8ã¤ã€‚

| å‘½ä»¤ | æ„å‘³ |
|:-:|:-|
| > | ãƒã‚¤ãƒ³ã‚¿ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã™ã‚‹ |
| < | ãƒã‚¤ãƒ³ã‚¿ã‚’ãƒ‡ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã™ã‚‹ |
| + | ãƒã‚¤ãƒ³ã‚¿ãŒæŒ‡ã—ã¦ã„ã‚‹è¦ç´ ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã™ã‚‹ |
| - | ãƒã‚¤ãƒ³ã‚¿ãŒæŒ‡ã—ã¦ã„ã‚‹è¦ç´ ã‚’ãƒ‡ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã™ã‚‹ |
| . | ãƒã‚¤ãƒ³ã‚¿ãŒæŒ‡ã—ã¦ã„ã‚‹è¦ç´ ã‚’ASCIIã‚³ãƒ¼ãƒ‰ã¨ã—ã¦æ–‡å­—ã‚’å‡ºåŠ›ã™ã‚‹ |
| , | å…¥åŠ›ã•ã‚ŒãŸæ–‡å­—ã®ASCIIã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚¤ãƒ³ã‚¿ä½ç½®ã«æ ¼ç´ã™ã‚‹ |
| [ | ãƒã‚¤ãƒ³ã‚¿ãŒæŒ‡ã—ã¦ã„ã‚‹è¦ç´ ãŒ0ãªã‚‰ã°å¯¾å¿œã™ã‚‹"]"ã®ç›´å¾Œã«é£›ã¶ |
| ] | å¯¾å¿œã™ã‚‹"["ã«é£›ã¶ |

***

ä»¥ä¸Šã§ã™ã€‚**ã“ã‚Œã§å…¨éƒ¨ã§ã™ã€‚**
ã—ã‹ã—ã“ã‚Œã ã‘å°ã•ãªè¨€èªã§ã‚ã‚ŠãªãŒã‚‰ãƒãƒ¥ãƒ¼ãƒªãƒ³ã‚°å®Œå…¨ã§ã‚ã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
ä¸Šã«æ›¸ã„ãŸè¨€èªä»•æ§˜ã‚‚ãƒãƒ¥ãƒ¼ãƒªãƒ³ã‚°ãƒã‚·ãƒ³ã«ä¼¼ã›ãŸã‚‚ã®ã¨è€ƒãˆã‚Œã°ã‚ã‹ã‚Šã‚„ã™ã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚

## ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’ä½œã£ã¦ã¿ãŸ
ã“ã‚Œã ã‘å°ã•ãªè¨€èªãªã‚‰ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã ã£ã¦ç°¡å˜ã«ä½œã‚Œã¾ã™ã€‚å®Œæˆå“ãŒã“ã¡ã‚‰ã«ãªã‚Šã¾ã™ã€‚

***

[bfc - BrainF\*\*k Compiler](https://github.com/reika727/bfc)

* å‹•ä½œç’°å¢ƒ
 * Ubuntu 20.04.2 LTS(64 bit)
 * GNU bash, version 5.0.17(1)-release (x86_64-pc-linux-gnu)

***

ã¾ãšå§‹ã‚ã«ã€Brainf\*\*kã‚’ã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èªã«ç¿»è¨³ã™ã‚‹ã¨ã“ã‚ã‹ã‚‰è€ƒãˆã¾ã™ã€‚
ã§ã™ãŒãã®å‰ã«ã€å¾Œã€…å¿…è¦ã«ãªã£ã¦ãã‚‹å¤‰æ•°ã‚„ã‚‰é–¢æ•°ã‚„ã‚‰ã‚’ç”¨æ„ã—ã¦ãŠãã¾ã™ã€‚ã“ã‚Œã¯ã‚ã–ã‚ã–ã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èªã§æ›¸ãã®ã‚‚å¤§å¤‰ã§ã™ã®ã§ã€Cè¨€èªã§æ›¸ã„ãŸã‚‚ã®ã‚’gccã«ç¿»è¨³ã—ã¦ã‚‚ã‚‰ã„ã¾ã—ã‚‡ã†ã€‚ãŸã ã—ã›ã£ã‹ããªã®ã§ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚¢ã‚»ãƒ³ãƒ–ãƒ©ã‚’é§†ä½¿ã—ã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæŠœãã§å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚`bfc_abs()`ãƒ»`bfc_memset()`ãƒ»`bfc_sbrk()`ãŒãã‚Œãã‚Œæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ã‚‹`abs()`ãƒ»`memset()`ãƒ»`sbrk()`ã®è‡ªå‰ã§ã®å®Ÿè£…ã«ãªã‚Šã¾ã™ã€‚

<details><summary>ã‚³ãƒ¼ãƒ‰</summary><div>

```c:libbf.c
#include <stddef.h>
#include <syscall.h>
#include <sys/types.h>

static int64_t bfc_abs(int64_t n)
{
    return n >= 0 ? n : -n;
}

static void bfc_memset(void *buf, char ch, u_int64_t n)
{
    for (u_int64_t i = 0; i < n; ++i) {
        *(char*)buf = ch;
        buf = (void*)((char*)buf + 1);
    }
}

static void* bfc_sbrk(int64_t inc)
{
    char *p;
    asm (
        "syscall"
        : "=a" (p)
        : "a" (SYS_brk), "D" (NULL)
    );
    asm (
        "syscall"
        :
        : "a" (SYS_brk), "D" (p + inc)
    );
    return p;
}

/* ç¢ºä¿ã•ã‚Œã¦ã„ã‚‹é ˜åŸŸã®å…ˆé ­ã¸ã®ãƒã‚¤ãƒ³ã‚¿ */
char *alloc_ptr;
/* ç¢ºä¿ã•ã‚Œã¦ã„ã‚‹é ˜åŸŸã®ã‚µã‚¤ã‚º */
u_int64_t sz;
/* Brainfuckã®ãƒã‚¤ãƒ³ã‚¿ */
char *bf_ptr;

/* åˆæœŸåŒ– */
void bfc_initialize(void)
{
    /* Brainfuckã¯æœ€ä½ã§ã‚‚30000ãƒã‚¤ãƒˆã®ã‚¼ãƒ­åŸ‹ã‚ã•ã‚ŒãŸé ˜åŸŸã‚’æŒã¡ã€
     * ãƒã‚¤ãƒ³ã‚¿ã¯åˆæœŸçŠ¶æ…‹ã§é ˜åŸŸã®å…ˆé ­ã‚’æŒ‡ã™[è¦å‡ºå…¸] */
    bf_ptr = alloc_ptr = (char*)bfc_sbrk(sz = 30000);
    bfc_memset(alloc_ptr, '\0', sz);
}

/* çµ‚äº†å‡¦ç† */
void bfc_finalize(void)
{
    bfc_sbrk(-(int64_t)sz);
}

/* é ˜åŸŸã®å†ç¢ºä¿ */
void bfc_realloc(void)
{
    /* ãƒã‚¤ãƒ³ã‚¿ãŒé ˜åŸŸã‚’ã¯ã¿å‡ºã—ãŸå ´åˆã€ãã®ã¯ã¿å‡ºãŸåˆ†ã®2å€ã®é ˜åŸŸã‚’è¶³ã—åˆã‚ã›ã¦å†ç¢ºä¿ã™ã‚‹ */
    const int64_t offset = bf_ptr - alloc_ptr;
    if (0 <= offset && (u_int64_t)offset < sz) {
        return;
    }
    const u_int64_t margin = (offset >= 0 ? offset - sz + 1 : (u_int64_t)bfc_abs(offset)) * 2;
    bfc_sbrk(margin);
    if (offset >= 0) {
        bfc_memset(alloc_ptr + sz, '\0', margin);
    } else {
        for (u_int64_t i = 0; i < sz; ++i) {
            alloc_ptr[margin + sz - i - 1] = alloc_ptr[sz - i - 1];
        }
        bfc_memset(alloc_ptr, '\0', margin);
        bf_ptr += margin;
    }
    sz += margin;
}
```

</div></details>

ã‚³ãƒ¡ãƒ³ãƒˆã«ã‚‚æ›¸ã‹ã‚Œã¦ã„ã¾ã™ãŒ`alloc_ptr`ãŒç¢ºä¿ã•ã‚Œã¦ã„ã‚‹é ˜åŸŸã®å…ˆé ­ã¸ã®ãƒã‚¤ãƒ³ã‚¿ã€`sz`ãŒç¢ºä¿ã•ã‚Œã¦ã„ã‚‹é ˜åŸŸã®ã‚µã‚¤ã‚ºã€`bf_ptr`ãŒBrainf\*\*kã®ãƒã‚¤ãƒ³ã‚¿ã«ãªã‚Šã¾ã™ã€‚

ã¾ãŸã€`bf_initialize()`ã¯åå‰ã®é€šã‚Šæœ€åˆã«å‘¼ã³å‡ºã™é–¢æ•°ã§ã™ã€‚Brainf\*\*kã®è¨€èªä»•æ§˜ã«å¾“ã„30000ãƒã‚¤ãƒˆã®ã‚¼ãƒ­åŸ‹ã‚ã•ã‚ŒãŸé ˜åŸŸã‚’ç¢ºä¿ã—ã¾ã™ã€‚ãã—ã¦`bf_finalize()`ã‚‚åå‰ã®é€šã‚Šæœ€å¾Œã«å‘¼ã³å‡ºã™é–¢æ•°ã§ã™ã€‚ç¢ºä¿ã—ã¦ã„ãŸé ˜åŸŸã‚’è§£æ”¾ã—ã¾ã™ã€‚

ä¸€ç•ªæ´»èºã—ã¦ãã‚Œã‚‹ã®ãŒ`bf_realloc`ã§ã™ã€‚å…ˆã»ã©æ›¸ã„ãŸã‚ˆã†ã«Brainf\*\*kã®ä½¿ãˆã‚‹é ˜åŸŸã¯ã¯ã˜ã‚30000ãƒã‚¤ãƒˆã—ã‹ãªã„ã®ã§ã€ãƒã‚¤ãƒ³ã‚¿ãŒã“ã®é ˜åŸŸã®å¤–ã«ã‚ã‚‹ã¨ãã«èª­ã¿å‡ºã—ãƒ»æ›¸ãè¾¼ã¿ã‚’è¡ŒãŠã†ã¨ã™ã‚‹ã¨ã‚»ã‚°ãƒ•ã‚©ã‚Šã¾ã™ã€‚ãªã®ã§ã€Brainf\*\*kã®ãƒã‚¤ãƒ³ã‚¿ãŒé ˜åŸŸã‚’ã¯ã¿å‡ºã—ãŸå ´åˆã€é ˜åŸŸã®å†ç¢ºä¿ãŒå¿…è¦ã¨ãªã‚Šã¾ã™ã€‚
ã“ã‚Œã‚’ã—ã¦ãã‚Œã‚‹ã®ãŒ```bf_realloc```ã¨ã„ã†ã‚ã‘ã§ã™ã€‚ã“ã„ã¤ã¯ãƒã‚¤ãƒ³ã‚¿ãŒã¯ã¿å‡ºã—ã¦ã—ã¾ã£ãŸåˆ†ã®2å€ã®é ˜åŸŸã‚’åŠ ãˆã¦ç¢ºä¿ã—ãªãŠã—ã¾ã™ã€‚å†ç¢ºä¿ã¯é‡ã„å‡¦ç†ãªã®ã§ã€ãªã‚‹ã¹ãå›æ•°ã‚’æ¸›ã‚‰ã™ãŸã‚ã«ã€Œã¯ã¿å‡ºãŸåˆ†ã®2å€ã€ã¨å°‘ã—ä½™è£•ã‚’ã‚‚ã£ã¦ç¢ºä¿ã—ã¦ã„ã¾ã™ã€‚

ã“ã®libbf.cã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«ã—ã¦å¾Œã§ä½¿ã„ã¾ã™ã€‚

```bash
$ gcc -c libbf.c
```

ã•ã¦Brainf\*\*kã«ã¯å‰è¿°ã®ã‚ˆã†ã«å‘½ä»¤ãŒ8ã¤ã—ã‹ãªãã€ã—ã‹ã‚‚å„å‘½ä»¤ã¨ãã‚Œã‚’è¡¨ã™ãƒˆãƒ¼ã‚¯ãƒ³ã¯ä¸€å¯¾ä¸€ã§å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚ãªã®ã§å­—å¥è§£æãƒ»æ§‹æ–‡è§£æã®å¿…è¦ã¯çš†ç„¡ã«ç­‰ã—ãã€å„å‘½ä»¤ã‚’æ©Ÿæ¢°çš„ã«ã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èªã«è¨³ã—ã¦ã„ãã ã‘ã§ãªã‚“ã¨ã‹ãªã‚Šãã†ã§ã™ã€‚

ã§ã™ãŒã€ã„ãã¤ã‹å·¥å¤«ã®ä½™åœ°ã¯ã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°`++++++++++`ã¨ã„ã†å‘½ä»¤åˆ—ãŒã‚ã‚‹ã¨ãã€ã€Œãƒã‚¤ãƒ³ã‚¿ä½ç½®ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã™ã‚‹ã€ã‚’10å›ã‚‚ç¹°ã‚Šè¿”ã™ã‚ˆã‚Šã¯ã€Œãƒã‚¤ãƒ³ã‚¿ä½ç½®ã®ãƒ‡ãƒ¼ã‚¿ã«10ã‚’è¶³ã™ã€ã¨ã—ãŸæ–¹ãŒåŠ¹ç‡çš„ãªã®ã¯æ˜ç™½ã§ã™ã€‚

ã“ã®ã“ã¨ã‚’è¸ã¾ãˆã¦å„å‘½ä»¤ã‚’ç¿»è¨³ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

### >>>...(>ãŒNå€‹)
```nasm
; bf_ptrã‚’Nå€‹åˆ†é€²ã‚ã‚‹
addq $N, bf_ptr(%rip)
; bf_ptr >= alloc_ptr + szã ã£ãŸã‚‰å†ç¢ºä¿ã‚’è¡Œã†
mov alloc_ptr(%rip), %rax
add sz(%rip), %rax
cmp bf_ptr(%rip), %rax
jg LABEL
call bf_realloc
LABEL:
```

### &lt;&lt;&lt;...(&lt;ãŒNå€‹)
```nasm
; bf_ptrã‚’Nå€‹åˆ†æˆ»ã™
subq $N, bf_ptr(%rip)
; bf_ptr < alloc_ptrã ã£ãŸã‚‰å†ç¢ºä¿ã‚’è¡Œã†
mov alloc_ptr(%rip), %rax
cmp bf_ptr(%rip), %rax
jle LABEL
call bf_realloc
LABEL:
```

~~ä½™è«‡ã§ã™ãŒã€`>`å‘½ä»¤ã¨`<`å‘½ä»¤ã¯ä¸Šè¨˜ã®ã‚ˆã†ã«`addq`ã€`subq`ã¨ã›ãšã«`add`ã€`sub`ã¨ã—ãŸå ´åˆå®Ÿè¡Œé€Ÿåº¦ãŒã‚ã¡ã‚ƒãã¡ã‚ƒé…ããªã‚Šã¾ã—ãŸã€‚ç†ç”±ãŒã‚ˆãã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§ã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èªã«è©³ã—ã„æ–¹ã¯ã”æ•™ç¤ºã„ãŸã ã‘ã‚Œã°å¹¸ã„ã§ã™â€¦~~
**EDIT:** @fujitanozomu æ§˜ã‹ã‚‰ã”æŒ‡æ‘˜ã‚’ã„ãŸã ãã¾ã—ãŸã€‚ã‚³ãƒ¡ãƒ³ãƒˆæ¬„ã®æ–¹ã‚’å‚ç…§é¡˜ã„ã¾ã™m(_ _)m

### +++...(+ãŒNå€‹)
```nasm
mov bf_ptr(%rip), %rax
addb $N, (%rax)
```

### ---...(-ãŒNå€‹)
```nasm
mov bf_ptr(%rip), %rax
subb $N, (%rax)
```

ãŸã ã®`add`ã‚„`sub`ã ã¨`bf_ptr(%rip)`ã®æŒ‡ã—ã¦ã„ã‚‹ä½ç½®ã«ç›´æ¥Nã‚’è¶³ã—ãŸã‚Šå¼•ã„ãŸã‚Šã—ãŸã¨ãã«ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã—ã¦éš£æ¥ã™ã‚‹ãƒ¡ãƒ¢ãƒªã¾ã§æ›¸ãæ›ã‚ã£ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚‹ã®ã§ã€`addb`ãƒ»`subb`ã‚’ä½¿ã„ã¾ã™ã€‚

### ......(.ãŒNå€‹)
`sys_write`ã‚’ä½¿ã£ã¦ã„ãã¾ã™ã€‚

```nasm
mov $N, %rcx
LABEL:
push %rcx
; ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ç•ªå·
mov $1, %rax
; ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿(1 -> æ¨™æº–å‡ºåŠ›)
mov $1, %rdi
; æ›¸ãå‡ºã™æ–‡å­—åˆ—
mov bf_ptr(%rip), %rsi
; æ›¸ãå‡ºã™æ–‡å­—æ•°
mov $1, %rdx
syscall
pop %rcx
loop LABEL
```

N=1ã®å ´åˆã¯`rcx`ã‚’pushã—ãŸã‚Špopã—ãŸã‚Šã™ã‚‹ã ã‘ç„¡é§„ãªã®ã§ã“ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚

```nasm
mov $1, %rax
mov $1, %rdi
mov bf_ptr(%rip), %rsi
mov $1, %rdx
syscall
```

### ,,,...(,ãŒNå€‹)
ã“ã¡ã‚‰ã¯sys_readã‚’ä½¿ã£ã¦ã„ãã¾ã™ã€‚

```nasm
mov $N, %rcx
LABEL:
push %rcx
; ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ç•ªå·
mov $0, %rax
; ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿(0 -> æ¨™æº–å…¥åŠ›)
mov $0, %rdi
; èª­ã¿è¾¼ã‚“ã æ–‡å­—åˆ—ã®æ ¼ç´å…ˆ
mov bf_ptr(%rip), %rsi
; èª­ã¿è¾¼ã‚€æ–‡å­—æ•°
mov $1, %rdx
syscall
pop %rcx
loop LABEL
```

ã“ã¡ã‚‰ã‚‚N=1ã®ã¨ãã¯ã“ã†ã—ã¾ã™ã€‚

```nasm
mov $0, %rax
mov $0, %rdi
mov bf_ptr(%rip), %rsi
mov $1, %rdx
syscall
```

### [ã¨]
ãã¡ã‚“ã¨ãƒ«ãƒ¼ãƒ—ã™ã‚‹ã«ã¯[ã¨]ã®é–“ã§ãƒ©ãƒ™ãƒ«ã®åå‰ãŒãã¡ã‚“ã¨å¯¾å¿œã—ã¦ã„ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚
ã§ã™ãŒä»Šå›ä½¿ã£ãŸC++ã«ã¯`std::stack`ãŒã‚ã‚‹ã®ã§ã€ã“ã‚Œã‚’ä½¿ãˆã°ãƒ©ãƒ™ãƒ«ã®ç®¡ç†ã‚‚ç°¡å˜ã«ã§ãã¾ã™ã€‚
è©³ã—ãã¯~~é¢å€’ãªã®ã§~~ç«¯æŠ˜ã‚‰ã›ã¦ã„ãŸã ãã¾ã™ã€‚

```nasm
LOOP_BEGIN:
mov bf_ptr(%rip), %rax
movzbq (%rax), %rax
cmp $0, %al
je LOOP_END
```

```nasm
jmp LOOP_BEGIN
LOOP_END:
```

## ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚½ãƒ¼ã‚¹ã‹ã‚‰å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹
ã“ã‚Œã§Brainf\*\*kã®ç¿»è¨³ãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã€[ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ãƒ»ã‚¨ãƒ”ãƒ­ãƒ¼ã‚°](https://qiita.com/tobira-code/items/75d3034aed8bb9828981#function-prologue)ãŠã‚ˆã³`sys_exit`ã®å‘¼ã³å‡ºã—ã¨ã€å…ˆè¿°ã®`bf_initialize`ãƒ»`bf_finalize`ã®å‘¼ã³å‡ºã—ã‚’åŠ ãˆã¦ã‚„ã‚Œã°ç«‹æ´¾ãªã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚½ãƒ¼ã‚¹ã«ãªã‚Šã¾ã™ã€‚

```nasm:translated.s
.global _start
_start:
; ä¸‹ã®2è¡ŒãŒãƒ—ãƒ­ãƒ­ãƒ¼ã‚°
push %rbp
mov %rsp, %rbp
call bf_initialize
; ã“ã“ã«Brainf**kã®ç¿»è¨³ãŒå…¥ã‚‹
call bf_finalize
; ä¸‹ã®2è¡ŒãŒã‚¨ãƒ”ãƒ­ãƒ¼ã‚°
mov %rbp, %rsp
pop %rbp
; çµ‚äº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹0ã§sys_exitã‚’å‘¼ã³å‡ºã™
mov $60, %rax
mov $0, %rdi
syscall
```

ã‚ã¨ã¯ã“ã‚Œã‚’ã•ã£ãä½œã£ãŸlibbf.oã¨ä¸€ç·’ã«gccã«æ¸¡ã›ã°å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ãŒã§ãã¾ã™ã€‚

```bash
$ gcc translated.s libbf.o
```

ã§ã™ãŒã€ã›ã£ã‹ãã€Œã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã€ã‚’ä½œã£ã¦ã„ã‚‹ã®ã§ã™ã‹ã‚‰æœ€å¾Œã®æœ€å¾Œã§gccã«é ¼ã‚ŠãŸããªã„ã¨ã„ã†æ°—æŒã¡ãŒã‚ã‚Šã¾ã™ã€‚ã›ã£ã‹ããªã®ã§gccã‚’ä½¿ã‚ãšã«å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦ã¿ã¾ã™ã€‚

ã¾ãšã¯translated.sã‚’**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**ã«å¤‰æ›ã—ã¾ã™ã€‚ã“ã‚Œã«ã¯**as**ã‚³ãƒãƒ³ãƒ‰ãŒä½¿ãˆã¾ã™ã€‚ä½¿ã„æ–¹ã¯ç°¡å˜ã§ã™ã€‚

```bash
$ as translated.s -o translated.o
```

æ¬¡ã«**ld**ã‚³ãƒãƒ³ãƒ‰ã§**ãƒªãƒ³ã‚¯**ã‚’è¡Œã„ã¾ã™ã€‚ã“ã£ã¡ã‚‚ç°¡å˜ã§ã™ã€‚

```bash
$ ld libbf.o translated.o -o executable.out
```

# å®Ÿè¡Œä¾‹
ã¨ã„ã†ã“ã¨ã§ã‚ã§ãŸãå®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã€å‹•ã‹ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚
è©³ã—ãã¯[githubã®æ–¹](https://github.com/reika727/bfc)ã®ã‚Šã©ã¿ã‚’è¦‹ã¦ãã ã•ã„ã€‚

```Brainfuck:hello.bf
+++++++++[>++++++++>+++++++++++>+++>+<<<<-]>.>++.+++++++..+++.
>+++++.<<+++++++++++++++.>.+++.------.--------.>+.>+.
```

```bash
$ make hello.out
$ ./hello.out
Hello World!
```

ğŸ‘‘ğŸºå„ªå‹ğŸºğŸ‘‘

# ã¾ã¨ã‚
TL;DRã«ä¹—ã›ã¦ãŸgifã¯[ãƒãƒ³ãƒ‡ãƒ«ãƒ–ãƒ­é›†åˆã‚’æç”»ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ](https://github.com/fabianishere/brainfuck/blob/master/examples/mandelbrot/mandelbrot.bf)ã‚’å‹•ã‹ã—ã¦ã„ãŸæ™‚ã®ã‚‚ã®ãªã®ã§ã™ãŒã€è¦‹ã¦ã®é€šã‚Šé‡ãŸã„ã§ã™ã€‚ã¤ã¾ã‚Šã¾ã æœ€é©åŒ–ã®ä½™åœ°ã¯ã‚ã‚Šãã†ã§ã™ã€‚

ã‚ã¨Qiitaã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆã£ã¦Brainf\*\*kã«å¯¾å¿œã—ã¦ã‚‹ã‚“ã§ã™ã­â€¦ãªãœâ€¦?

# å‚è€ƒ
[sbrkã®ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«ã‚’ç›´æ¥å‘¼ã³å‡ºã™](https://tyfkda.github.io/blog/2019/11/18/sbrk.html)
